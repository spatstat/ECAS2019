---
title: "Notes for session 1"
author: "Adrian Baddeley and Ege Rubak"
date: "2019-07-15"
output: html
---

## Introduction

```{r, echo=FALSE, results="hide"}
library(spatstat)
requireversion(spatstat, "1.60-1.005")
```

_Spatial data_= data attributed to spatial locations

Three main types of spatial data:

* spatial variable (field) eg temperature
* regional aggregate data eg accident counts in each state
* spatial point patterns eg locations of crimes/accidents

```{r, echo=FALSE, results="hide", fig.width=9, fig.height=3, out.width="100%"}
W <- Window(austates)
aW <- area.owin(W)
mu <- function(x,y){ (50+y)/aW }
XX <- rLGCP("exp", mu, list(var=10/aW, scale=5), win=W)
Lam <- attr(XX, "Lambda")[W, drop=FALSE]
f <- 10 * (Lam - min(Lam))/diff(range(Lam)) - 5
f <- blur(f, 0.2, bleed=FALSE, normalise=TRUE)
f <- f + aW * as.im(funxy(mu, W))
X <- if(npoints(XX) <= 40) XX else rthin(XX, 40/npoints(XX))
agg <- list(do.labels=TRUE, labels=rpois(7, 20))
plot(solist(field=f, regional=austates, points=X),
     panel.args=function(i, ...) if(i==2) agg else list(),
     main="", main.panel="")
```

This workshop is about the analysis of _spatial point patterns_

We will use the `spatstat` package in `R`

```{r}
library(spatstat)
```

## Spatial point pattern terminology

### Points

Spatial coordinates of locations

### Window

The window $W$ is the spatial region where
points were (or could have been) observed

### Covariates

Covariates are explanatory variables

Often a covariate is a function $Z(u), \quad u \in W$ defined at every spatial
location.

Alternatively, other kinds of spatial data can be treated as
explanatory data. Usually we need to translate them into spatial functions. 

### Marks

Marks are attributes of the individual events or things,
eg type of cell, type of accident

Marks are methodologically different from covariates:
marks are part of the "response", not the "explanatory variable"

## Software and data 

### Spatstat

```{r}
library(spatstat)
```

A point pattern dataset is represented an object belonging to the class
`"ppp"` (planar point pattern). Some datasets are included in the package:

```{r}
plot(gordon)
class(gordon)
gordon
head(as.data.frame(gordon))
```

The window of observation for a point pattern can be extracted by:

```{r}
W <- Window(gordon)
W
class(W)
```

This is an object of class `"owin"` (observation window)
representing a spatial region.




### Data file formats

Data may be provided in many different file formats

* text file, CSV file
* shapefile

Brief pointers on data wrangling

For convenience we will use datasets already installed in _spatstat_


